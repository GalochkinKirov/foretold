{"version":3,"sources":["../../src/models/measurement.js"],"names":["Sequelize","require","module","exports","sequelize","DataTypes","Model","define","id","type","UUID","primaryKey","defaultValue","UUIDV4","allowNull","value","JSON","competitorType","ENUM","description","TEXT","measurableId","agentId","relevantAt","DATE","get","getDataValue","associate","models","Measurable","belongsTo","foreignKey","Agent","TaggedMeasurement","Measurement","as","TaggedBy","hasMany"],"mappings":"AAAA;;AACA,MAAMA,YAAYC,QAAQ,WAAR,CAAlB;;AAEAC,OAAOC,OAAP,GAAiB,CAACC,SAAD,EAAYC,SAAZ,KAA0B;AACzC,MAAIC,QAAQF,UAAUG,MAAV,CAAiB,aAAjB,EAAgC;AAC1CC,QAAI;AACFC,YAAMJ,UAAUK,IAAV,EADJ;AAEFC,kBAAY,IAFV;AAGFC,oBAAcZ,UAAUa,MAHtB;AAIFC,iBAAW;AAJT,KADsC;AAO1CC,WAAO;AACLN,YAAMJ,UAAUW,IADX;AAELF,iBAAW;AAFN,KAPmC;AAW1CG,oBAAgB;AACdR,YAAMJ,UAAUa,IAAV,CAAe,CAAC,WAAD,EAAc,aAAd,EAA6B,aAA7B,CAAf,CADQ;AAEdN,oBAAc,aAFA;AAGdE,iBAAW;AAHG,KAX0B;AAgB1CK,iBAAa;AACXV,YAAMJ,UAAUe,IADL;AAEXN,iBAAW;AAFA,KAhB6B;AAoB1CO,kBAAc;AACZZ,YAAMJ,UAAUK,IADJ;AAEZI,iBAAW;AAFC,KApB4B;AAwB1CQ,aAAS;AACPb,YAAMJ,UAAUK,IADT;AAEPI,iBAAW;AAFJ,KAxBiC;AA4B1CS,gBAAY;AACVT,iBAAW,IADD;AAEVL,YAAMT,UAAUwB,IAFN;AAGVC,YAAM;AACJ,eAAO,KAAKC,YAAL,CAAkB,YAAlB,KAAmC,KAAKA,YAAL,CAAkB,WAAlB,CAA1C;AACD;AALS;AA5B8B,GAAhC,CAAZ;AAoCApB,QAAMqB,SAAN,GAAkB,UAAUC,MAAV,EAAkB;AAClCtB,UAAMuB,UAAN,GAAmBvB,MAAMwB,SAAN,CAAgBF,OAAOC,UAAvB,EAAmC;AACpDE,kBAAY;AADwC,KAAnC,CAAnB;AAGAzB,UAAM0B,KAAN,GAAc1B,MAAMwB,SAAN,CAAgBF,OAAOI,KAAvB,EAA8B;AAC1CD,kBAAY;AAD8B,KAA9B,CAAd;AAGAzB,UAAM2B,iBAAN,GAA0B3B,MAAMwB,SAAN,CAAgBF,OAAOM,WAAvB,EAAoC;AAC5DH,kBAAY,qBADgD;AAE5DI,UAAI;AAFwD,KAApC,CAA1B;AAIA7B,UAAM8B,QAAN,GAAiB9B,MAAM+B,OAAN,CAAcT,OAAOM,WAArB,EAAkC;AACjDH,kBAAY,qBADqC;AAEjDI,UAAI;AAF6C,KAAlC,CAAjB;AAID,GAfD;AAgBA,SAAO7B,KAAP;AACD,CAtDD","file":"measurement.js","sourcesContent":["'use strict';\nconst Sequelize = require('sequelize')\n\nmodule.exports = (sequelize, DataTypes) => {\n  var Model = sequelize.define('Measurement', {\n    id: {\n      type: DataTypes.UUID(),\n      primaryKey: true,\n      defaultValue: Sequelize.UUIDV4,\n      allowNull: false,\n    },\n    value: {\n      type: DataTypes.JSON,\n      allowNull: false\n    },\n    competitorType: {\n      type: DataTypes.ENUM([\"OBJECTIVE\", \"COMPETITIVE\", \"AGGREGATION\"]),\n      defaultValue: \"COMPETITIVE\",\n      allowNull: true,\n    },\n    description: {\n      type: DataTypes.TEXT,\n      allowNull: true \n    },\n    measurableId: {\n      type: DataTypes.UUID,\n      allowNull: false\n    },\n    agentId: {\n      type: DataTypes.UUID,\n      allowNull: true\n    },\n    relevantAt: {\n      allowNull: true,\n      type: Sequelize.DATE,\n      get() {\n        return this.getDataValue('relevantAt') || this.getDataValue('createdAt')\n      }\n    },\n  });\n  Model.associate = function (models) {\n    Model.Measurable = Model.belongsTo(models.Measurable, {\n      foreignKey: 'measurableId'\n    })\n    Model.Agent = Model.belongsTo(models.Agent, {\n      foreignKey: 'agentId'\n    })\n    Model.TaggedMeasurement = Model.belongsTo(models.Measurement, {\n      foreignKey: 'taggedMeasurementId',\n      as: 'TaggedMeasurement'\n    })\n    Model.TaggedBy = Model.hasMany(models.Measurement, {\n      foreignKey: 'taggedMeasurementId',\n      as: 'TaggedBy'\n    })\n  }\n  return Model;\n};\n"]}